document.getElementById('newsForm').addEventListener('submit', function(e) {
    e.preventDefault();

    const newsText = document.getElementById('newsText').value;
    const newsFiles = document.getElementById('newsFile').files;

    if (newsText.trim() === '' && newsFiles.length === 0) {
        alert('‚ö†Ô∏è Please enter news text or upload at least one file.');
        return;
    }

    // Additional validation
    if (newsText.trim().length < 10 && newsFiles.length === 0) {
        alert('‚ö†Ô∏è Please enter at least 10 characters of news text for accurate detection.');
        return;
    }

    // Hide previous results
    document.getElementById('result').classList.add('hidden');
    document.getElementById('batchResults').classList.add('hidden');

    if (newsFiles.length > 0) {
        // Batch processing for files
        processBatchFiles(newsFiles);
    } else {
        // Single text analysis
        analyzeNews(newsText, 'Text Input');
    }
});

async function analyzeNews(text, fileName = 'Text Input') {
    try {
        const response = await fetch('http://localhost:5000/predict', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ text: text })
        });

        if (!response.ok) {
            throw new Error('API request failed');
        }

        const result = await response.json();

        if (fileName === 'Text Input') {
            // Single result display
            const resultDiv = document.getElementById('result');
            const resultText = document.getElementById('resultText');

            resultDiv.classList.remove('hidden', 'real', 'fake');

            if (result.prediction === 'fake') {
                resultDiv.classList.add('fake');
                resultText.innerHTML = `
                    <strong>üö® FAKE NEWS DETECTED!</strong><br>
                    Confidence: ${Math.round(result.confidence * 100)}%<br>
                    <small>Fake Probability: ${Math.round(result.probabilities.fake * 100)}% | Real Probability: ${Math.round(result.probabilities.real * 100)}%</small>
                `;
            } else {
                resultDiv.classList.add('real');
                resultText.innerHTML = `
                    <strong>‚úÖ LEGITIMATE NEWS</strong><br>
                    Confidence: ${Math.round(result.confidence * 100)}%<br>
                    <small>Fake Probability: ${Math.round(result.probabilities.fake * 100)}% | Real Probability: ${Math.round(result.probabilities.real * 100)}%</small>
                `;
            }
        } else {
            // Return result for batch processing
            return { fileName, result: {
                isFake: result.prediction === 'fake',
                confidence: Math.round(result.confidence * 100),
                fakeScore: Math.round(result.probabilities.fake * 100),
                realScore: Math.round(result.probabilities.real * 100)
            } };
        }
    } catch (error) {
        console.error('Error analyzing news:', error);
        // Fallback to local detection if API fails
        const result = detectFakeNews(text);

        if (fileName === 'Text Input') {
            const resultDiv = document.getElementById('result');
            const resultText = document.getElementById('resultText');

            resultDiv.classList.remove('hidden', 'real', 'fake');

            if (result.isFake) {
                resultDiv.classList.add('fake');
                resultText.innerHTML = `
                    <strong>üö® FAKE NEWS DETECTED! (Fallback)</strong><br>
                    Confidence: ${result.confidence}%<br>
                    <small>Fake Score: ${result.fakeScore} | Real Score: ${result.realScore}</small>
                `;
            } else {
                resultDiv.classList.add('real');
                resultText.innerHTML = `
                    <strong>‚úÖ LEGITIMATE NEWS (Fallback)</strong><br>
                    Confidence: ${result.confidence}%<br>
                    <small>Fake Score: ${result.fakeScore} | Real Score: ${result.realScore}</small>
                `;
            }
        } else {
            return { fileName, result };
        }
    }
}

async function processBatchFiles(files) {
    const allResults = [];

    for (const file of files) {
        const reader = new FileReader();
        await new Promise((resolve) => {
            reader.onload = async function(e) {
                const text = e.target.result;
                // Split the text into individual news items (assuming each line is a separate news)
                const newsItems = text.split('\n').filter(line => line.trim().length > 0);
                const promises = newsItems.map((item, index) => analyzeNews(item.trim(), `${file.name} - Line ${index + 1}`));
                const results = await Promise.all(promises);
                allResults.push(...results);
                resolve();
            };
            reader.readAsText(file);
        });
    }

    displayBatchResults(allResults);
}

function displayBatchResults(results) {
    const batchResultsDiv = document.getElementById('batchResults');
    const resultsTableBody = document.getElementById('resultsTableBody');

    resultsTableBody.innerHTML = '';

    results.forEach(({ fileName, result }) => {
        const tr = document.createElement('tr');
        tr.className = result.isFake ? 'fake' : 'real';

        tr.innerHTML = `
            <td>${fileName}</td>
            <td>${result.isFake ? 'üö® FAKE NEWS DETECTED!' : '‚úÖ LEGITIMATE NEWS'}</td>
            <td>${result.confidence}%</td>
            <td>${result.fakeScore}</td>
            <td>${result.realScore}</td>
        `;

        resultsTableBody.appendChild(tr);
    });

    batchResultsDiv.classList.remove('hidden');
}

function detectFakeNews(text) {
    // Enhanced detection logic with expanded keywords and weighted scoring
    const fakeKeywords = {
        'breaking': 15,
        'shocking': 12,
        'unbelievable': 10,
        'exclusive': 8,
        'you won\'t believe': 10,
        'conspiracy': 20,
        'secret': 15,
        'hidden truth': 18,
        'exposed': 12,
        'scandal': 14,
        'crisis': 8,
        'emergency': 8,
        'urgent': 6,
        'warning': 7,
        'alert': 6,
        'bombshell': 16,
        'revelation': 12,
        'insider': 10,
        'leaked': 13,
        'classified': 15,
        'top secret': 18,
        'cover-up': 20,
        'hoax': 25,
        'fake news': 30,
        'propaganda': 22,
        'manipulation': 18,
        'deception': 16,
        'lie': 12,
        'fabricated': 20,
        'false': 14,
        'misinformation': 24,
        'disinformation': 26,
        'clickbait': 15,
        'viral': 8,
        'trending': 6,
        'must see': 7,
        'you need to know': 9,
        'they don\'t want you to know': 25,
        'wake up': 10,
        'red pill': 12,
        'sheeple': 14,
        'deep state': 20,
        'illuminati': 18,
        'new world order': 22,
        'globalist': 16,
        'elites': 12,
        'mainstream media': 15,
        'msm': 12,
        'controlled opposition': 20,
        'psyop': 18,
        'false flag': 24,
        'staged': 16,
        'crisis actor': 20,
        'paid protester': 18,
        'astroturfing': 22
    };

    const realKeywords = {
        'according to sources': 20,
        'study shows': 25,
        'experts say': 22,
        'official statement': 28,
        'press release': 26,
        'government report': 30,
        'scientific research': 28,
        'peer reviewed': 32,
        'fact check': 30,
        'verified': 26,
        'confirmed': 24,
        'evidence': 22,
        'data': 20,
        'statistics': 23,
        'analysis': 21,
        'investigation': 25,
        'independent': 22,
        'reliable source': 26,
        'primary source': 28,
        'original document': 30,
        'court records': 29,
        'public records': 27,
        'witness testimony': 25,
        'expert opinion': 24,
        'academic study': 28,
        'research paper': 30,
        'journal article': 29,
        'official data': 27,
        'government statistics': 28,
        'census data': 26,
        'survey results': 24,
        'empirical evidence': 30,
        'controlled study': 29,
        'double-blind': 28,
        'meta-analysis': 31,
        'systematic review': 30,
        'longitudinal study': 27,
        'cross-sectional': 25,
        'qualitative research': 23,
        'quantitative data': 26,
        'statistical significance': 28,
        'correlation': 20,
        'causation': 22,
        'methodology': 24,
        'transparency': 23,
        'accountability': 22,
        'oversight': 21,
        'regulatory compliance': 26,
        'ethical standards': 25,
        'professional conduct': 23,
        'report': 15,
        'announcement': 14,
        'policy': 16,
        'legislation': 18,
        'election': 12,
        'court': 14,
        'justice': 13,
        'law': 12,
        'regulation': 15,
        'compliance': 14,
        'audit': 16,
        'inspection': 15,
        'oversight committee': 20,
        'parliament': 18,
        'congress': 18,
        'senate': 17,
        'house of representatives': 19,
        'supreme court': 20,
        'federal': 14,
        'state': 12,
        'local': 10,
        'municipality': 13,
        'county': 11,
        'city council': 15,
        'mayor': 12,
        'governor': 14,
        'president': 16,
        'minister': 14,
        'secretary': 13,
        'director': 12,
        'commissioner': 15,
        'agency': 13,
        'department': 14,
        'bureau': 12,
        'office': 11,
        'administration': 15,
        'executive': 13,
        'legislative': 14,
        'judicial': 15,
        'constitution': 18,
        'amendment': 16,
        'bill': 14,
        'act': 13,
        'resolution': 15,
        'debate': 12,
        'hearing': 14,
        'testimony': 16,
        'deposition': 15,
        'affidavit': 17,
        'plea': 12,
        'verdict': 14,
        'sentence': 13,
        'appeal': 15,
        'ruling': 16,
        'decision': 14,
        'judgment': 15,
        'case law': 18,
        'precedent': 17,
        'statute': 16,
        'ordinance': 14,
        'by-law': 13,
        'directive': 15,
        'guideline': 14,
        'protocol': 13,
        'procedure': 12,
        'standard': 11,
        'benchmark': 13,
        'metric': 12,
        'indicator': 11,
        'measure': 10,
        'assessment': 14,
        'evaluation': 15,
        'review': 13,
        'audit': 16,
        'inspection': 15,
        'monitoring': 14,
        'surveillance': 13,
        'tracking': 12,
        'reporting': 11,
        'disclosure': 15,
        'transparency': 16,
        'accountability': 17,
        'responsibility': 14,
        'duty': 12,
        'obligation': 13,
        'commitment': 14,
        'pledge': 12,
        'promise': 11,
        'guarantee': 13,
        'assurance': 14,
        'warranty': 12,
        'certification': 15,
        'accreditation': 16,
        'approval': 14,
        'authorization': 15,
        'permission': 13,
        'license': 14,
        'permit': 12,
        'clearance': 13,
        'endorsement': 14,
        'support': 11,
        'endorsement': 12,
        'backing': 10,
        'advocacy': 13,
        'champion': 11,
        'proponent': 12,
        'defender': 13,
        'guardian': 14,
        'protector': 12,
        'safeguard': 13,
        'shield': 11,
        'buffer': 10,
        'cushion': 9,
        'mitigation': 14,
        'prevention': 13,
        'protection': 12,
        'security': 11,
        'safety': 10,
        'well-being': 12,
        'health': 11,
        'welfare': 13,
        'benefit': 12,
        'advantage': 11,
        'gain': 10,
        'profit': 9,
        'return': 8,
        'yield': 9,
        'outcome': 10,
        'result': 9,
        'impact': 11,
        'effect': 10,
        'influence': 12,
        'consequence': 13,
        'implication': 14,
        'ramification': 15,
        'repercussion': 14,
        'aftermath': 12,
        'sequel': 10,
        'follow-up': 11,
        'continuation': 12,
        'extension': 11,
        'expansion': 13,
        'growth': 12,
        'development': 14,
        'progress': 13,
        'advancement': 15,
        'improvement': 14,
        'enhancement': 15,
        'upgrade': 13,
        'modernization': 16,
        'innovation': 15,
        'invention': 14,
        'discovery': 13,
        'breakthrough': 16,
        'milestone': 14,
        'achievement': 13,
        'accomplishment': 14,
        'success': 12,
        'triumph': 13,
        'victory': 11,
        'win': 9,
        'gain': 8,
        'profit': 7,
        'benefit': 10,
        'advantage': 9,
        'edge': 8,
        'upper hand': 10,
        'leverage': 11,
        'strength': 10,
        'power': 9,
        'authority': 12,
        'control': 11,
        'command': 10,
        'dominance': 12,
        'supremacy': 13,
        'hegemony': 14,
        'influence': 11,
        'sway': 9,
        'clout': 10,
        'weight': 8,
        'prestige': 12,
        'reputation': 11,
        'standing': 10,
        'status': 9,
        'rank': 8,
        'position': 9,
        'place': 7,
        'role': 8,
        'function': 9,
        'duty': 10,
        'responsibility': 11,
        'obligation': 10,
        'task': 8,
        'job': 7,
        'work': 6,
        'labor': 7,
        'effort': 8,
        'endeavor': 9,
        'enterprise': 10,
        'venture': 9,
        'project': 8,
        'initiative': 10,
        'program': 9,
        'scheme': 8,
        'plan': 7,
        'strategy': 9,
        'tactic': 8,
        'approach': 9,
        'method': 8,
        'technique': 9,
        'procedure': 8,
        'process': 9,
        'system': 8,
        'framework': 10,
        'structure': 9,
        'organization': 11,
        'institution': 12,
        'establishment': 11,
        'foundation': 10,
        'basis': 8,
        'groundwork': 9,
        'platform': 8,
        'stage': 7,
        'arena': 8,
        'field': 7,
        'domain': 9,
        'realm': 8,
        'sphere': 9,
        'sector': 8,
        'industry': 9,
        'market': 8,
        'economy': 10,
        'finance': 9,
        'business': 8,
        'commerce': 9,
        'trade': 8,
        'exchange': 7,
        'transaction': 9,
        'deal': 7,
        'agreement': 8,
        'contract': 9,
        'pact': 8,
        'treaty': 9,
        'alliance': 10,
        'partnership': 9,
        'collaboration': 10,
        'cooperation': 9,
        'union': 8,
        'association': 9,
        'society': 8,
        'community': 9,
        'group': 7,
        'team': 6,
        'crew': 7,
        'squad': 8,
        'unit': 7,
        'division': 8,
        'department': 9,
        'branch': 8,
        'section': 7,
        'segment': 8,
        'part': 6,
        'portion': 7,
        'component': 8,
        'element': 7,
        'aspect': 8,
        'feature': 7,
        'characteristic': 9,
        'trait': 7,
        'attribute': 8,
        'quality': 7,
        'property': 8,
        'nature': 7,
        'essence': 8,
        'core': 7,
        'heart': 6,
        'soul': 7,
        'spirit': 8,
        'mind': 6,
        'intellect': 8,
        'reason': 7,
        'logic': 8,
        'rationality': 9,
        'intelligence': 10,
        'wisdom': 9,
        'knowledge': 8,
        'understanding': 9,
        'comprehension': 10,
        'insight': 9,
        'perception': 8,
        'awareness': 9,
        'consciousness': 10,
        'cognition': 9,
        'thought': 7,
        'idea': 6,
        'concept': 7,
        'notion': 6,
        'belief': 7,
        'opinion': 6,
        'view': 5,
        'perspective': 8,
        'outlook': 7,
        'standpoint': 8,
        'angle': 6,
        'slant': 7,
        'bias': 6,
        'prejudice': 7,
        'discrimination': 9,
        'inequality': 8,
        'disparity': 7,
        'gap': 5,
        'difference': 6,
        'variation': 7,
        'diversity': 8,
        'variety': 7,
        'range': 6,
        'spectrum': 8,
        'array': 6,
        'selection': 7,
        'choice': 6,
        'option': 7,
        'alternative': 8,
        'possibility': 7,
        'potential': 8,
        'opportunity': 7,
        'chance': 6,
        'prospect': 7,
        'hope': 5,
        'expectation': 8,
        'anticipation': 9,
        'forecast': 8,
        'prediction': 7,
        'projection': 8,
        'estimate': 7,
        'calculation': 8,
        'assessment': 9,
        'evaluation': 8,
        'judgment': 7,
        'decision': 6,
        'choice': 5,
        'selection': 6,
        'pick': 4,
        'election': 7,
        'vote': 5,
        'ballot': 6,
        'referendum': 8,
        'plebiscite': 9,
        'poll': 5,
        'survey': 6,
        'questionnaire': 8,
        'inquiry': 7,
        'investigation': 8,
        'probe': 6,
        'examination': 7,
        'inspection': 6,
        'check': 4,
        'verification': 8,
        'confirmation': 7,
        'validation': 8,
        'authentication': 10,
        'certification': 9,
        'endorsement': 8,
        'approval': 7,
        'sanction': 8,
        'authorization': 9,
        'permission': 7,
        'consent': 6,
        'agreement': 7,
        'acceptance': 8,
        'admission': 7,
        'acknowledgment': 9,
        'recognition': 8,
        'appreciation': 9,
        'gratitude': 7,
        'thanks': 5,
        'praise': 6,
        'commendation': 8,
        'accolade': 7,
        'honor': 6,
        'award': 5,
        'prize': 6,
        'trophy': 7,
        'medal': 6,
        'certificate': 8,
        'diploma': 7,
        'degree': 6,
        'qualification': 8,
        'credential': 7,
        'license': 6,
        'permit': 5,
        'pass': 4,
        'ticket': 5,
        'voucher': 6,
        'coupon': 5,
        'discount': 6,
        'rebate': 5,
        'refund': 6,
        'compensation': 8,
        'reimbursement': 9,
        'repayment': 7,
        'settlement': 8,
        'resolution': 7,
        'solution': 6,
        'answer': 5,
        'reply': 4,
        'response': 6,
        'reaction': 5,
        'feedback': 7,
        'comment': 6,
        'remark': 5,
        'note': 4,
        'observation': 7,
        'finding': 6,
        'discovery': 7,
        'revelation': 8,
        'disclosure': 7,
        'announcement': 8,
        'declaration': 7,
        'statement': 6,
        'proclamation': 8,
        'edict': 6,
        'decree': 7,
        'order': 5,
        'command': 6,
        'directive': 7,
        'instruction': 6,
        'guidance': 7,
        'advice': 5,
        'counsel': 6,
        'recommendation': 8,
        'suggestion': 6,
        'proposal': 7,
        'offer': 5,
        'bid': 4,
        'tender': 5,
        'quotation': 6,
        'estimate': 5,
        'quote': 4,
        'price': 5,
        'cost': 4,
        'fee': 5,
        'charge': 6,
        'rate': 4,
        'tariff': 6,
        'duty': 5,
        'tax': 4,
        'levy': 5,
        'assessment': 6,
        'imposition': 7,
        'penalty': 6,
        'fine': 4,
        'sanction': 5,
        'punishment': 6,
        'discipline': 7,
        'correction': 6,
        'reform': 5,
        'change': 4,
        'modification': 6,
        'alteration': 7,
        'adjustment': 6,
        'revision': 5,
        'update': 4,
        'upgrade': 5,
        'improvement': 6,
        'enhancement': 7,
        'betterment': 6,
        'advancement': 7,
        'progress': 6,
        'development': 7,
        'evolution': 6,
        'transformation': 8,
        'transition': 7,
        'shift': 4,
        'move': 3,
        'step': 4,
        'stride': 5,
        'leap': 4,
        'jump': 3,
        'bound': 4,
        'advance': 5,
        'forward': 4,
        'onward': 5,
        'ahead': 4,
        'progressive': 7,
        'forward-looking': 8,
        'innovative': 7,
        'creative': 6,
        'original': 6,
        'novel': 5,
        'new': 3,
        'fresh': 4,
        'recent': 4,
        'current': 5,
        'contemporary': 8,
        'modern': 5,
        'up-to-date': 6,
        'latest': 4,
        'newest': 5,
        'cutting-edge': 7,
        'state-of-the-art': 8,
        'advanced': 6,
        'sophisticated': 8,
        'complex': 5,
        'intricate': 6,
        'elaborate': 6,
        'detailed': 5,
        'comprehensive': 8,
        'thorough': 6,
        'extensive': 6,
        'broad': 4,
        'wide': 3,
        'vast': 4,
        'huge': 3,
        'large': 3,
        'big': 2,
        'great': 4,
        'grand': 4,
        'majestic': 6,
        'impressive': 6,
        'remarkable': 7,
        'extraordinary': 8,
        'exceptional': 7,
        'outstanding': 7,
        'excellent': 6,
        'superb': 5,
        'fine': 3,
        'good': 3,
        'better': 4,
        'best': 3,
        'superior': 6,
        'supreme': 6,
        'ultimate': 6,
        'optimal': 5,
        'ideal': 4,
        'perfect': 5,
        'flawless': 6,
        'impeccable': 7,
        'pristine': 6,
        'pure': 3,
        'clean': 3,
        'clear': 3,
        'transparent': 7,
        'honest': 4,
        'truthful': 5,
        'sincere': 5,
        'genuine': 5,
        'authentic': 6,
        'real': 3,
        'true': 3,
        'factual': 5,
        'accurate': 5,
        'precise': 5,
        'exact': 4,
        'correct': 5,
        'right': 3,
        'proper': 4,
        'appropriate': 7,
        'suitable': 5,
        'fitting': 4,
        'apt': 3,
        'relevant': 6,
        'pertinent': 6,
        'applicable': 7,
        'germane': 5,
        'material': 5,
        'significant': 7,
        'important': 6,
        'crucial': 5,
        'vital': 4,
        'essential': 6,
        'necessary': 6,
        'required': 5,
        'mandatory': 6,
        'obligatory': 7,
        'compulsory': 7,
        'imperative': 7,
        'indispensable': 9,
        'critical': 6,
        'key': 3,
        'central': 5,
        'core': 3,
        'fundamental': 8,
        'basic': 4,
        'elementary': 7,
        'primary': 5,
        'principal': 6,
        'main': 3,
        'major': 4,
        'chief': 4,
        'leading': 5,
        'foremost': 6,
        'preeminent': 7,
        'prominent': 6,
        'notable': 5,
        'distinguished': 9,
        'eminent': 5,
        'illustrious': 8,
        'renowned': 6,
        'famous': 5,
        'celebrated': 7,
        'acclaimed': 6,
        'praised': 5,
        'commended': 7,
        'applauded': 6,
        'lauded': 4,
        'extolled': 5,
        'glorified': 6,
        'heroic': 5,
        'valiant': 5,
        'brave': 4,
        'courageous': 7,
        'bold': 3,
        'daring': 4,
        'fearless': 6,
        'intrepid': 6,
        'adventurous': 8,
        'venturesome': 8,
        'audacious': 6,
        'plucky': 4,
        'gutsy': 4,
        'spunky': 4,
        'spirited': 6,
        'lively': 4,
        'vivacious': 7,
        'animated': 6,
        'energetic': 7,
        'dynamic': 5,
        'vigorous': 6,
        'robust': 5,
        'strong': 4,
        'powerful': 6,
        'mighty': 4,
        'potent': 4,
        'forceful': 6,
        'effective': 6,
        'efficient': 6,
        'productive': 7,
        'fruitful': 6,
        'successful': 7,
        'prosperous': 7,
        'thriving': 6,
        'flourishing': 8,
        'blooming': 5,
        'burgeoning': 7,
        'expanding': 6,
        'growing': 4,
        'increasing': 6,
        'rising': 4,
        'ascending': 6,
        'climbing': 5,
        'soaring': 4,
        'skyrocketing': 8,
        'booming': 4,
        'exploding': 5,
        'surge': 4,
        'spike': 4,
        'jump': 3,
        'leap': 3,
        'boost': 4,
        'increase': 5,
        'gain': 3,
        'improvement': 7,
        'enhancement': 8,
        'upturn': 4,
        'recovery': 5,
        'revival': 5,
        'renaissance': 8,
        'resurgence': 7,
        'comeback': 5,
        'return': 4,
        'restoration': 8,
        'rehabilitation': 11,
        'renewal': 5,
        'regeneration': 9,
        'rejuvenation': 9,
        'revitalization': 11,
        'refreshment': 8,
        'recharge': 6,
        'reinvigoration': 11,
        'reanimation': 8,
        'resurrection': 9,
        'rebirth': 5,
        'reincarnation': 10,
        'recreation': 7,
        'reconstruction': 10,
        'rebuilding': 7,
        'repair': 4,
        'fix': 2,
        'mend': 3,
        'heal': 3,
        'cure': 3,
        'remedy': 4,
        'solution': 5,
        'resolution': 7,
        'settlement': 7,
        'agreement': 6,
        'accord': 4,
        'pact': 3,
        'treaty': 4,
        'alliance': 6,
        'coalition': 6,
        'union': 3,
        'federation': 7,
        'confederation': 10,
        'league': 4,
        'association': 8,
        'society': 5,
        'club': 3,
        'organization': 9,
        'institution': 9,
        'establishment': 10,
        'foundation': 8,
        'corporation': 8,
        'company': 5,
        'firm': 3,
        'enterprise': 7,
        'business': 6,
        'concern': 5,
        'venture': 5,
        'operation': 6,
        'activity': 6,
        'action': 4,
        'deed': 3,
        'act': 2,
        'feat': 3,
        'achievement': 9,
        'accomplishment': 11,
        'success': 5,
        'triumph': 5,
        'victory': 5,
        'win': 2,
        'conquest': 6,
        'mastery': 5,
        'dominance': 7,
        'supremacy': 7,
        'control': 5,
        'command': 5,
        'authority': 7,
        'power': 4,
        'influence': 7,
        'sway': 3,
        'clout': 4,
        'leverage': 6,
        'weight': 4,
        'prestige': 6,
        'reputation': 8,
        'standing': 6,
        'status': 4,
        'rank': 3,
        'position': 6,
        'place': 4,
        'role': 3,
        'function': 6,
        'purpose': 5,
        'goal': 3,
        'objective': 7,
        'aim': 2,
        'target': 5,
        'destination': 8,
        'end': 2,
        'result': 4,
        'outcome': 5,
        'consequence': 8,
        'effect': 4,
        'impact': 4,
        'influence': 7,
        'bearing': 5,
        'relevance': 6,
        'significance': 9,
        'importance': 7,
        'value': 4,
        'worth': 4,
        'merit': 4,
        'quality': 5,
        'excellence': 7,
        'superiority': 9,
        'distinction': 8,
        'eminence': 6,
        'prominence': 7,
        'notability': 7,
        'fame': 3,
        'celebrity': 6,
        'renown': 4,
        'glory': 4,
        'honor': 4,
        'credit': 4,
        'recognition': 8,
        'acknowledgment': 11,
        'appreciation': 9,
        'gratitude': 6,
        'thanks': 4,
        'praise': 4,
        'commendation': 9,
        'accolade': 6,
        'award': 4,
        'prize': 4,
        'trophy': 4,
        'medal': 4,
        'certificate': 7,
        'diploma': 5,
        'degree': 4,
        'qualification': 10,
        'credential': 7,
        'license': 5,
        'permit': 4,
        'pass': 3,
        'ticket': 4,
        'voucher': 5,
        'coupon': 4,
        'discount': 5,
        'rebate': 4,
        'refund': 5,
        'compensation': 9,
        'reimbursement': 10,
        'repayment': 6,
        'settlement': 7,
        'resolution': 7,
        'solution': 5,
        'answer': 4,
        'reply': 3,
        'response': 5,
        'reaction': 5,
        'feedback': 6,
        'comment': 5,
        'remark': 4,
        'note': 3,
        'observation': 8,
        'finding': 5,
        'discovery': 6,
        'revelation': 7,
        'disclosure': 7,
        'announcement': 8,
        'declaration': 6,
        'statement': 6,
        'proclamation': 9,
        'edict': 4,
        'decree': 5,
        'order': 4,
        'command': 5,
        'directive': 7,
        'instruction': 7,
        'guidance': 6,
        'advice': 4,
        'counsel': 5,
        'recommendation': 10,
        'suggestion': 6,
        'proposal': 6,
        'offer': 4,
        'bid': 2,
        'tender': 4,
        'quotation': 6,
        'estimate': 5,
        'quote': 3,
        'price': 4,
        'cost': 3,
        'fee': 3,
        'charge': 5,
        'rate': 3,
        'tariff': 5,
        'duty': 4,
        'tax': 3,
        'levy': 4,
        'assessment': 7,
        'imposition': 7,
        'penalty': 5,
        'fine': 3,
        'sanction': 5,
        'punishment': 7,
        'discipline': 7,
        'correction': 7,
        'reform': 4,
        'change': 4,
        'modification': 8,
        'alteration': 7,
        'adjustment': 7,
        'revision': 6,
        'update': 4,
        'upgrade': 5,
        'improvement': 8,
        'enhancement': 9,
        'betterment': 7,
        'advancement': 8,
        'progress': 6,
        'development': 8,
        'evolution': 6,
        'transformation': 10,
        'transition': 7,
        'shift': 4,
        'move': 3,
        'step': 4,
        'stride': 5,
        'leap': 4,
        'jump': 3,
        'bound': 4,
        'advance': 5,
        'forward': 4,
        'onward': 5,
        'ahead': 4,
        'progressive': 8,
        'forward-looking': 10,
        'innovative': 7,
        'creative': 6,
        'original': 6,
        'novel': 4,
        'new': 2,
        'fresh': 4,
        'recent': 4,
        'current': 5,
        'contemporary': 9,
        'modern': 4,
        'up-to-date': 6,
        'latest': 4,
        'newest': 5,
        'cutting-edge': 8,
        'state-of-the-art': 10,
        'advanced': 6,
        'sophisticated': 9,
        'complex': 5,
        'intricate': 7,
        'elaborate': 7,
        'detailed': 5,
        'comprehensive': 9,
        'thorough': 6,
        'extensive': 7,
        'broad': 4,
        'wide': 3,
        'vast': 4,
        'huge': 3,
        'large': 3,
        'big': 2,
        'great': 4,
        'grand': 4,
        'majestic': 6,
        'impressive': 7,
        'remarkable': 8,
        'extraordinary': 9,
        'exceptional': 8,
        'outstanding': 8,
        'excellent': 6,
        'superb': 5,
        'fine': 3,
        'good': 3,
        'better': 4,
        'best': 3,
        'superior': 7,
        'supreme': 6,
        'ultimate': 6,
        'optimal': 5,
        'ideal': 4,
        'perfect': 5,
        'flawless': 6,
        'impeccable': 8,
        'pristine': 6,
        'pure': 3,
        'clean': 3,
        'clear': 3,
        'transparent': 8,
        'honest': 4,
        'truthful': 5,
        'sincere': 5,
        'genuine': 6,
        'authentic': 7,
        'real': 3,
    };

    // Heuristics for fake news detection
    const heuristics = {
        allCapsWords: (text) => {
            const words = text.split(/\s+/);
            const allCapsCount = words.filter(word => word === word.toUpperCase() && word.length > 2).length;
            return allCapsCount > words.length * 0.1 ? 15 : 0; // If more than 10% of words are all caps
        },
        exclamationMarks: (text) => {
            const count = (text.match(/!/g) || []).length;
            return Math.min(count * 2, 20); // Up to 20 points for excessive exclamation marks
        },
        questionMarks: (text) => {
            const count = (text.match(/\?/g) || []).length;
            return Math.min(count * 1.5, 15); // Up to 15 points for excessive question marks
        },
        sensationalLanguage: (text) => {
            const sensationalWords = ['amazing', 'incredible', 'mind-blowing', 'life-changing', 'revolutionary'];
            let score = 0;
            sensationalWords.forEach(word => {
                if (text.toLowerCase().includes(word)) score += 5;
            });
            return score;
        },
        lackOfSources: (text) => {
            const sourceIndicators = ['according to', 'cited', 'source', 'reference', 'study', 'research'];
            const hasSources = sourceIndicators.some(indicator => text.toLowerCase().includes(indicator));
            return hasSources ? 0 : 10; // Penalty for lack of sources
        },
        shortLength: (text) => {
            return text.length < 200 ? 8 : 0; // Short articles might be less reliable
        },
        emotionalLanguage: (text) => {
            const emotionalWords = ['hate', 'love', 'fear', 'anger', 'outrage', 'disgust', 'joy', 'sadness'];
            let score = 0;
            emotionalWords.forEach(word => {
                if (text.toLowerCase().includes(word)) score += 3;
            });
            return Math.min(score, 15);
        }
    };

    let fakeScore = 0;
    let realScore = 0;

    const lowerText = text.toLowerCase();

    // Keyword scoring
    Object.entries(fakeKeywords).forEach(([keyword, weight]) => {
        if (lowerText.includes(keyword)) {
            fakeScore += weight;
        }
    });

    Object.entries(realKeywords).forEach(([keyword, weight]) => {
        if (lowerText.includes(keyword)) {
            realScore += weight;
        }
    });

    // Heuristic scoring
    Object.values(heuristics).forEach(heuristic => {
        fakeScore += heuristic(text);
    });

    // Length bonus for real news (longer articles tend to be more reliable)
    if (text.length > 1000) {
        realScore += 10;
    } else if (text.length > 500) {
        realScore += 5;
    }

    // Bias towards real if no strong fake indicators
    if (fakeScore < 50 && realScore > fakeScore) {
        realScore += 5;
    }

    const totalScore = fakeScore + realScore;
    const isFake = fakeScore > realScore;
    const confidence = totalScore > 0 ? Math.round((Math.abs(fakeScore - realScore) / totalScore) * 100) : 50;

    return { isFake, confidence, fakeScore, realScore };
}
